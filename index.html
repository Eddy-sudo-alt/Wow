<!doctype html>
<html lang="de">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Schiffe auf Wasser ‚Äî Top-Down mit Bl√§ttern & Wellen</title>
<style>
:root{
  --bg:#e8f9ff; --water1:#bfe8ff; --water2:#5fb0e6; --ui:#ffffffcc; --muted:#123;
}
html,body{height:100%;margin:0;font-family:Inter,system-ui,Roboto,Arial;color:var(--muted);background:linear-gradient(180deg,#f8feff,#e8f9ff);}
header{padding:12px 16px}
h1{margin:0;font-size:18px}
.hint{font-size:13px;margin:4px 0 0 0;color:#345}
.controls{display:flex;gap:8px;padding:10px 16px;align-items:center;flex-wrap:wrap}
button{background:var(--ui);border:0;padding:8px 12px;border-radius:10px;box-shadow:0 6px 18px rgba(20,50,80,0.06);cursor:pointer}
.stage-wrap{display:flex;align-items:center;justify-content:center;padding:10px;flex:1}
.stage{width:100%;max-width:980px;height:74vh;min-height:420px;border-radius:18px;box-shadow:0 14px 40px rgba(20,40,80,0.08);overflow:hidden;position:relative;background:transparent}
canvas{display:block;width:100%;height:100%}
footer{padding:10px 16px;font-size:13px;color:#445;text-align:center}
.panel{position:absolute;left:14px;top:14px;background:var(--ui);padding:8px 10px;border-radius:10px;backdrop-filter:blur(6px);box-shadow:0 4px 12px rgba(0,0,0,0.06)}
.small{font-size:13px}
@media (max-width:640px){ h1{font-size:16px} .controls{padding:8px} }
</style>
</head>
<body>
<header>
  <h1>Schiffe auf Wasser ‚Äî Top-Down mit Bl√§ttern & Wellen</h1>
  <p class="hint">Meditatives Spiel ‚Ä¢ Boote kreisen automatisch ‚Ä¢ Tippe/Klicke = Boot hinzuf√ºgen ‚Ä¢ Ziehen zum lenken ‚Ä¢ Sound an/aus</p>
</header>

<div class="controls">
  <button id="add">+ Boot</button>
  <button id="addLily">+ Seerose</button>
  <button id="addFish">+ Fisch</button>
  <button id="calm">Beruhigen</button>
  <button id="mute">üîä Aus/An</button>
  <div style="flex:1"></div>
  <button id="reset">Zur√ºcksetzen</button>
</div>

<div class="stage-wrap">
  <div class="stage" id="stage">
    <canvas id="c"></canvas>
    <div class="panel small" id="info">Boote: 0 ‚Ä¢ Seerosen: 0 ‚Ä¢ Fische: 0 ‚Ä¢ Bl√§tter: 0</div>
  </div>
</div>

<footer>Tipp: A f√ºr Boot, L f√ºr Seerose, F f√ºr Fisch ‚Äî Kein Wettbewerb, nur Entspannung.</footer>

<script>
/* --- Setup --- */
const canvas=document.getElementById('c'); const ctx=canvas.getContext('2d');
let DPR=Math.max(1,devicePixelRatio||1);
function resize(){DPR=Math.max(1,devicePixelRatio||1); canvas.width=canvas.clientWidth*DPR; canvas.height=canvas.clientHeight*DPR;}
window.addEventListener('resize',()=>{resize(); draw();}); resize();

const world={time:0,boats:[],lilies:[],fish:[],leaves:[],calmFactor:1,speedFactor:1,center:{x:0,y:0},rx:260,ry:140,muted:false};

/* Helper */
const rand=(a,b)=>Math.random()*(b-a)+a;
const clamp=(v,a,b)=>Math.max(a,Math.min(b,v));

/* Boat */
class Boat{constructor(angle,color='#ff9f6a',size=28){this.angle=angle;this.offset=rand(-12,12);this.speed=rand(0.18,0.36);this.color=color;this.size=size;this.dragging=false;this.id='b_'+Math.random().toString(36).slice(2,9);}
pos(){const cx=world.center.x,cy=world.center.y,rx=world.rx,ry=world.ry,a=this.angle;let x=cx+rx*Math.cos(a),y=cy+ry*Math.sin(a);const nx=Math.cos(a),ny=Math.sin(a);x+=this.offset*nx;y+=this.offset*ny;return{x,y};}
update(dt){if(!this.dragging){const wobble=Math.sin(world.time*1.5+(this.id.charCodeAt(2)||0))*0.03;this.angle+=(this.speed*(0.6+0.4*world.calmFactor)+wobble*0.05)*dt*world.speedFactor;this.offset+=Math.sin(world.time*0.7+this.angle*2)*0.02;this.offset=clamp(this.offset,-24,24);}}
draw(ctx){const p=this.pos(),s=this.size*DPR;ctx.save();ctx.translate(p.x*DPR,p.y*DPR);const rx=world.rx,ry=world.ry,a=this.angle;const tx=-rx*Math.sin(a),ty=ry*Math.cos(a);const rot=Math.atan2(ty,tx);ctx.rotate(rot);ctx.beginPath();ctx.ellipse(0,s*0.14,s*0.8*s*0.5,0,0,Math.PI*2);ctx.fillStyle="rgba(0,0,0,0.08)";ctx.fill();ctx.beginPath();ctx.moveTo(-s*0.6,0);ctx.quadraticCurveTo(0,s*0.7,s*0.6,0);ctx.lineTo(s*0.5,s*0.22);ctx.lineTo(-s*0.5,s*0.22);ctx.closePath();ctx.fillStyle=this.color;ctx.fill();ctx.fillStyle='rgba(255,255,255,0.9)';ctx.fillRect(-s*0.22,-s*0.05,s*0.44,s*0.14);ctx.restore();}}

class Lily{constructor(x,y,size=28){this.x=x;this.y=y;this.size=size;} draw(ctx){ctx.save();ctx.translate(this.x*DPR,this.y*DPR);const s=this.size*DPR;ctx.beginPath();ctx.ellipse(0,0,s*1.1,s*0.6,0,0,Math.PI*2);ctx.fillStyle='#2f9b5a';ctx.fill();ctx.beginPath();for(let i=0;i<5;i++){const a=i*(Math.PI*2/5);ctx.ellipse(Math.cos(a)*s*0.16, Math.sin(a)*s*0.16 - s*0.06, s*0.12, s*0.07, a,0,Math.PI*2);} ctx.fillStyle='#fff7e9';ctx.fill();ctx.restore();}}

class Fish{constructor(x,y,size=12,color='#8fd8a3'){this.x=x;this.y=y;this.size=size;this.color=color;this.phase=rand(0,Math.PI*2);} draw(ctx){ctx.save();ctx.translate(this.x*DPR,this.y*DPR);const s=this.size*DPR;ctx.beginPath();ctx.ellipse(0,0,s*0.9,s*0.5,0,0,Math.PI*2);ctx.fillStyle=this.color;ctx.fill();ctx.beginPath();ctx.moveTo(-s*0.9,0);ctx.lineTo(-s*1.3,-s*0.32);ctx.lineTo(-s*1.3,s*0.32);ctx.closePath();ctx.fill();ctx.restore();}}

class Leaf{constructor(x,y,size=10,color='#6ba85c'){this.x=x;this.y=y;this.size=size;this.color=color;this.phase=rand(0,Math.PI*2);} draw(ctx){ctx.save();ctx.translate(this.x*DPR,this.y*DPR);const s=this.size*DPR;ctx.beginPath();ctx.ellipse(0,0,s*1.2,s*0.6,Math.sin(this.phase),0,Math.PI*2);ctx.fillStyle=this.color;ctx.fill();ctx.restore();}}

/* Path */
function setPathParams(){const rect=canvas.getBoundingClientRect();world.center.x=rect.width*0.5;world.center.y=rect.height*0.52;const minDim=Math.min(rect.width,rect.height);world.rx=clamp(minDim*0.36,120,420);world.ry=clamp(minDim*0.18,70,260);} setPathParams();

/* Draw */
function draw(){const w=canvas.width,h=canvas.height;ctx.clearRect(0,0,w,h);setPathParams();
ctx.save(); ctx.fillStyle='#dff7e6'; ctx.fillRect(0,0,w,h);
ctx.beginPath(); ctx.ellipse(world.center.x*DPR,world.center.y*DPR,world.rx*DPR+20*DPR,world.ry*DPR+20*DPR,0,0,Math.PI*2);
const g=ctx.createLinearGradient(0,0,0,h); g.addColorStop(0,'#e9fbff'); g.addColorStop(0.5,'#bfe8ff'); g.addColorStop(1,'#66aee0'); ctx.fillStyle=g; ctx.fill();
ctx.beginPath(); ctx.ellipse(world.center.x*DPR,world.center.y*DPR,world.rx*DPR,world.ry*DPR,0,0,Math.PI*2); ctx.fillStyle='rgba(255,255,255,0.02)'; ctx.fill();
ctx.lineWidth=6*DPR; ctx.strokeStyle='rgba(0,0,0,0.06)'; ctx.stroke(); ctx.restore();

// gentle wave lines
ctx.save(); ctx.lineWidth=2*DPR; ctx.strokeStyle='rgba(255,255,255,0.25)';
for(let i=0;i<10;i++){ctx.beginPath();const phase=i*0.6+world.time*0.6;for(let t=0;t<=Math.PI*2+0.01;t+=0.04){const rx=world.rx*(1-0.02*i); const ry=world.ry*(1-0.02*i); const x=world.center.x+rx*Math.cos(t)+Math.sin(phase+t*1.8)*(i+1)*0.6; const y=world.center.y+ry*Math.sin(t)+Math.cos(phase+t*1.3)*(i+1)*0.3; if(t===0)ctx.moveTo(x*DPR,y*DPR);else ctx.lineTo(x*DPR,y*DPR);} ctx.stroke();}
ctx.restore();

// draw lilies
world.lilies.forEach(l=>l.draw(ctx));
// draw fish
world.fish.forEach(f=>f.draw(ctx));
// draw leaves
world.leaves.forEach(l=>{l.phase+=0.003; l.x+=Math.sin(world.time*0.7+l.phase)*0.05; l.y+=Math.cos(world.time*0.9+l.phase)*0.03; l.draw(ctx);});

// draw boats
const sorted=[...world.boats].sort((a,b)=>a.pos().y-b.pos().y); sorted.forEach(b=>b.draw(ctx));
}

/* Update loop */
let last=performance.now();
function frame(now){const dt=Math.min(0.05,(now-last)/1000);last=now;world.time+=dt;world.boats.forEach(b=>b.update(dt));world.fish.forEach((f,i)=>{f.x+=Math.sin(world.time*1.5+i)*0.02;f.y+=Math.cos(world.time*1.9+i)*0.015;});draw();requestAnimationFrame(frame);}
requestAnimationFrame(frame);

/* Add items */
function addBoat(angle=null){const a=angle===null?rand(0,Math.PI*2):angle;const colors=['#ff9f6a','#ffd66b','#8fd8a3','#9